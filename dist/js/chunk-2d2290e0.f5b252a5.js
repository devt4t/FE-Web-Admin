(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2290e0"],{dc8c:function(t,a,e){"use strict";e.r(a);var l=function(){var t=this,a=t._self._c;return a("v-dialog",{attrs:{"content-class":"rounded-xl mx-1","max-width":"1200px",scrollable:"",persistent:""},model:{value:t.showModal,callback:function(a){t.showModal=a},expression:"showModal"}},[a("v-card",[a("v-card-title",{staticClass:"mb-1 green darken-1 rounded-xl pa-2 pr-3 ma-1"},[a("span",{staticClass:"white--text"},[a("v-btn",{staticClass:"white dark--text mr-1",attrs:{fab:"","x-small":""}},[a("v-icon",{attrs:{color:"grey darken-3"}},[t._v("mdi-file-account")])],1),t._v(" Export Excel")],1),a("v-icon",{staticClass:"ml-auto",attrs:{color:"white lighten-1"},on:{click:function(a){t.showModal=!1}}},[t._v("mdi-close-circle")])],1),a("v-card-text",[a("v-overlay",{staticClass:"rounded-xl",attrs:{absolute:"",value:t.loading.show}},[a("div",{staticClass:"d-flex flex-column justify-center align-center"},[a("LottieAnimation",{ref:"anim",staticStyle:{height:"64px"},attrs:{animationData:t.lottie.data.loading,loop:!0}}),a("p",{staticClass:"mt-2 mb-0"},[t._v(t._s(t.loading.text)+" "),a("v-progress-circular",{attrs:{size:17,width:3,indeterminate:"",color:"white"}})],1),a("v-progress-linear",{attrs:{color:"blue-grey",height:"25"},scopedSlots:t._u([{key:"default",fn:function({value:e}){return[a("strong",[t._v(t._s(Math.ceil(e))+"%")])]}}]),model:{value:t.loading.progress,callback:function(a){t.$set(t.loading,"progress",a)},expression:"loading.progress"}})],1)]),a("table",{staticStyle:{"border-collapse":"collapse","min-height":"400px"},attrs:{id:"tableForExport"}},[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"},attrs:{colspan:"8"}},[t._v(t._s(t.download.title))])]),a("tr",[a("td",{staticStyle:{"text-align":"left"},attrs:{colspan:"8"}},[t._v("Tahun Program: "+t._s(t.programYear))])]),a("tr",[a("td",{staticStyle:{"text-align":"left"},attrs:{colspan:"8"}},[t._v("Export Time: "+t._s(Date()))])]),a("tr",[a("td",{staticStyle:{"text-align":"left"},attrs:{colspan:"8"}},[t._v("Total Data: "+t._s(t.table.data.length))])]),a("tr"),a("tr",[a("th",[t._v("No")]),t._l(t.table.fields,(function(e,l){return a("th",{key:"headerTbl-"+l},[t._v(" "+t._s(e.label)+" ")])}))],2)]),a("tbody",t._l(t.table.data,(function(e,l){return a("tr",{key:"table-row-"+l},[a("td",[t._v(t._s(l+1))]),t._l(t.table.fields,(function(l,o){return a("td",{key:"itemTbl-"+o},[t._v(" "+t._s(e[l.key])+" ")])}))],2)})),0)])],1),a("v-card-actions",[a("v-btn",{staticClass:"my-4",attrs:{rounded:"",outlined:"",disabled:t.loading.show,color:"green",block:""},on:{click:function(a){return t.downloadExcel()}}},[a("v-icon",{staticClass:"mr-1"},[t._v("mdi-microsoft-excel")]),t._v(" Download Excel ")],1)],1)],1)],1)},o=[],s=e("bc3a"),r=e.n(s),n=e("86e6"),i=e("1d71"),d={name:"OldGekoExport",props:{show:{type:Boolean,default:!1},programYear:{type:String,default:""},defaultData:{type:Array,default:[]}},components:{LottieAnimation:n["a"]},data:()=>({download:{title:"Export Lahan"},loading:{progress:0,show:!1,text:""},lottie:{data:{loading:i}},table:{fields:[{label:"Management Unit",key:"mu_name"},{label:"Unit Manager",key:"um_name"},{label:"Target Area",key:"ta_name"},{label:"Field Coordinator",key:"fc_name"},{label:"Field Facilitator",key:"ff_name"},{label:"Desa",key:"village_name"},{label:"Petani",key:"farmer_name"},{label:"Status Petani",key:"farmer_status"},{label:"Jenis Bibit",key:"seeds_name"},{label:"Kayu",key:"total_wood"},{label:"Mpts",key:"total_mpts"},{label:"Total",key:"total_wood_mpts"},{label:"Status Lahan",key:"land_status"}],data:[],trees:[]}}),computed:{showModal:{get:function(){return this.show},set:function(t){0==t&&this.$emit("close")}}},watch:{show:{async handler(t){t&&this.getTableData()}}},mounted(){},methods:{downloadExcel(){const t=document.getElementById("tableForExport"),a=XLSX.utils.table_to_book(t);XLSX.writeFile(a,this.download.title+".xlsx")},async getTableData(){try{let t=this.loading;this.table.data=[],t.show=!0,t.text="Preparing data...",t.progress=0;let a=this.$store;const e=this.defaultData.map(t=>t.kode);console.log(this.defaultData);const l=100,o=Math.ceil(e.length/l);console.log(o);for(let s=0;s<o;s++){const n=JSON.parse(JSON.stringify(e)).slice(s*l,(s+1)*l),i=a.getters.getApiUrl("ExportFarmerAllAdminNew"),d=await r.a.post(i,{program_year:this.programYear,farmer_no:n},a.state.apiConfig);this.table.data.push(...d.data),t.progress=Math.round(100/o*(s+1))}}finally{this.table.data.length>0&&this.downloadExcel(),this.loading.show=!1,this.loading.progress=100}}}},c=d,u=e("2877"),g=e("6544"),h=e.n(g),p=e("8336"),m=e("b0af"),b=e("99d9"),_=e("169a"),f=e("132d"),y=e("a797"),x=e("490a"),w=e("8e36"),v=Object(u["a"])(c,l,o,!1,null,null,null);a["default"]=v.exports;h()(v,{VBtn:p["a"],VCard:m["a"],VCardActions:b["a"],VCardText:b["c"],VCardTitle:b["d"],VDialog:_["a"],VIcon:f["a"],VOverlay:y["a"],VProgressCircular:x["a"],VProgressLinear:w["a"]})}}]);
//# sourceMappingURL=chunk-2d2290e0.f5b252a5.js.map