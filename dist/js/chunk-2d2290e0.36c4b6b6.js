(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2290e0"],{dc8c:function(t,a,e){"use strict";e.r(a);var l=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-dialog",{attrs:{"content-class":"rounded-xl mx-1","max-width":"1200px",scrollable:"",persistent:""},model:{value:t.showModal,callback:function(a){t.showModal=a},expression:"showModal"}},[e("v-card",[e("v-card-title",{staticClass:"mb-1 green darken-1 rounded-xl pa-2 pr-3 ma-1"},[e("span",{staticClass:"white--text"},[e("v-btn",{staticClass:"white dark--text mr-1",attrs:{fab:"","x-small":""}},[e("v-icon",{attrs:{color:"grey darken-3"}},[t._v("mdi-file-account")])],1),t._v(" Export Excel")],1),e("v-icon",{staticClass:"ml-auto",attrs:{color:"white lighten-1"},on:{click:function(a){t.showModal=!1}}},[t._v("mdi-close-circle")])],1),e("v-card-text",[e("v-overlay",{staticClass:"rounded-xl",attrs:{absolute:"",value:t.loading.show}},[e("div",{staticClass:"d-flex flex-column justify-center align-center"},[e("LottieAnimation",{ref:"anim",staticStyle:{height:"64px"},attrs:{animationData:t.lottie.data.loading,loop:!0}}),e("p",{staticClass:"mt-2 mb-0"},[t._v(t._s(t.loading.text)+" "),e("v-progress-circular",{attrs:{size:17,width:3,indeterminate:"",color:"white"}})],1),e("v-progress-linear",{attrs:{color:"blue-grey",height:"25"},scopedSlots:t._u([{key:"default",fn:function(a){var l=a.value;return[e("strong",[t._v(t._s(Math.ceil(l))+"%")])]}}]),model:{value:t.loading.progress,callback:function(a){t.$set(t.loading,"progress",a)},expression:"loading.progress"}})],1)]),e("table",{staticStyle:{"border-collapse":"collapse","min-height":"400px"},attrs:{id:"tableForExport"}},[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"},attrs:{colspan:"8"}},[t._v(t._s(t.download.title))])]),e("tr",[e("td",{staticStyle:{"text-align":"left"},attrs:{colspan:"8"}},[t._v("Tahun Program: "+t._s(t.programYear))])]),e("tr",[e("td",{staticStyle:{"text-align":"left"},attrs:{colspan:"8"}},[t._v("Export Time: "+t._s(Date()))])]),e("tr",[e("td",{staticStyle:{"text-align":"left"},attrs:{colspan:"8"}},[t._v("Total Data: "+t._s(t.table.data.length))])]),e("tr"),e("tr",[e("th",[t._v("No")]),t._l(t.table.fields,(function(a,l){return e("th",{key:"headerTbl-"+l},[t._v(" "+t._s(a.label)+" ")])}))],2)]),e("tbody",t._l(t.table.data,(function(a,l){return e("tr",{key:"table-row-"+l},[e("td",[t._v(t._s(l+1))]),t._l(t.table.fields,(function(l,o){return e("td",{key:"itemTbl-"+o},[t._v(" "+t._s(a[l.key])+" ")])}))],2)})),0)])],1),e("v-card-actions",[e("v-btn",{staticClass:"my-4",attrs:{rounded:"",outlined:"",disabled:t.loading.show,color:"green",block:""},on:{click:function(a){return t.downloadExcel()}}},[e("v-icon",{staticClass:"mr-1 "},[t._v("mdi-microsoft-excel")]),t._v(" Download Excel ")],1)],1)],1)],1)},o=[],r=e("2909"),n=e("1da1"),s=(e("96cf"),e("d81d"),e("fb6a"),e("bc3a")),i=e.n(s),d=e("86e6"),c=e("1d71"),u={name:"OldGekoExport",props:{show:{type:Boolean,default:!1},programYear:{type:String,default:""},defaultData:{type:Array,default:[]}},components:{LottieAnimation:d["a"]},data:function(){return{download:{title:"Export Lahan"},loading:{progress:0,show:!1,text:""},lottie:{data:{loading:c}},table:{fields:[{label:"Management Unit",key:"mu_name"},{label:"Unit Manager",key:"um_name"},{label:"Target Area",key:"ta_name"},{label:"Field Coordinator",key:"fc_name"},{label:"Field Facilitator",key:"ff_name"},{label:"Desa",key:"village_name"},{label:"Petani",key:"farmer_name"},{label:"Status Petani",key:"farmer_status"},{label:"Jenis Bibit",key:"seeds_name"},{label:"Kayu",key:"total_wood"},{label:"Mpts",key:"total_mpts"},{label:"Total",key:"total_wood_mpts"},{label:"Status Lahan",key:"land_status"}],data:[],trees:[]}}},computed:{showModal:{get:function(){return this.show&&this.getTableData(),this.show},set:function(t){0==t&&this.$emit("close")}}},watch:{},mounted:function(){},methods:{downloadExcel:function(){var t=document.getElementById("tableForExport"),a=XLSX.utils.table_to_book(t);XLSX.writeFile(a,"".concat(this.download.title,".xlsx"))},getTableData:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var e,l,o,n,s,d,c,u,p,g;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:a.prev=0,e=t.loading,t.table.data=[],e.show=!0,e.text="Preparing data...",e.progress=0,l=t.$store,o=t.defaultData.map((function(t){return t.kode})),n=100,s=Math.ceil(o.length/n),console.log(s),d=0;case 12:if(!(d<s)){a.next=23;break}return u=JSON.parse(JSON.stringify(o)).slice(d*n,(d+1)*n),p=l.getters.getApiUrl("ExportFarmerAllAdminNew"),a.next=17,i.a.post(p,{program_year:t.programYear,farmer_no:u},l.state.apiConfig);case 17:g=a.sent,(c=t.table.data).push.apply(c,Object(r["a"])(g.data)),e.progress=Math.round(100/s*(d+1));case 20:d++,a.next=12;break;case 23:return a.prev=23,t.table.data.length>0&&t.downloadExcel(),t.loading.show=!1,t.loading.progress=100,a.finish(23);case 28:case"end":return a.stop()}}),a,null,[[0,,23,28]])})))()}}},p=u,g=e("2877"),m=e("6544"),b=e.n(m),f=e("8336"),h=e("b0af"),_=e("99d9"),v=e("169a"),x=e("132d"),w=e("a797"),y=e("490a"),k=e("8e36"),C=Object(g["a"])(p,l,o,!1,null,null,null);a["default"]=C.exports;b()(C,{VBtn:f["a"],VCard:h["a"],VCardActions:_["a"],VCardText:_["c"],VCardTitle:_["d"],VDialog:v["a"],VIcon:x["a"],VOverlay:w["a"],VProgressCircular:y["a"],VProgressLinear:k["a"]})}}]);
//# sourceMappingURL=chunk-2d2290e0.36c4b6b6.js.map