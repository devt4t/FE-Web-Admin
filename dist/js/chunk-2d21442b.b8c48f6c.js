(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21442b"],{afd4:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",[e("confirmation",{attrs:{type:t.dialogs.confirmation.type,show:t.dialogs.confirmation.model},on:{close:()=>t.dialogs.confirmation.model=!1,confirm:()=>t.verificationOrRejectConfirm()}}),e("v-dialog",{attrs:{"max-width":"1000","content-class":"rounded-xl",persistent:"",scrollable:""},model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}},[e("v-card",{attrs:{color:"orange"}},[e("v-card-title",{staticClass:"white--text"},[e("v-icon",{staticClass:"mr-1",attrs:{color:"white"}},[t._v("mdi-message-bulleted")]),t._v(" Detail "),e("v-divider",{staticClass:"mx-2",attrs:{color:"white"}}),e("v-icon",{attrs:{color:"white"},on:{click:()=>t.showDialog=!1}},[t._v("mdi-close-circle")])],1),e("v-card-text",{class:"requested"==t.data.main.status?"pb-0":""},[t.loading.show?e("v-overlay",{attrs:{"justify-center":"","align-center":"",absolute:""}},[e("div",{staticClass:"d-flex flex-column align-center justify-center"},[e("v-progress-circular",{attrs:{size:80,width:7,indeterminate:"",color:"white"}}),e("p",{staticClass:"mb-0 text-center mt-4"},[t._v(t._s(t.loading.text||"Loading..."))])],1)]):t._e(),e("v-card",{staticClass:"rounded-xl"},[e("v-card-text",{staticClass:"pb-2"},[e("v-row",{staticClass:"align-center ma-0"},[e("v-tooltip",{attrs:{bottom:"","content-class":"rounded-xl"},scopedSlots:t._u([{key:"activator",fn:function({on:a,attrs:i}){return[e("v-chip",t._g(t._b({staticStyle:{"text-transform":"uppercase"},attrs:{color:t.statusColorAndIcon(t.data.main.status,"color","request")}},"v-chip",i,!1),a),[e("v-icon",{staticClass:"mr-1"},[t._v(t._s(t.statusColorAndIcon(t.data.main.status,"icon","request")))]),t._v(" "+t._s(t.data.main.request_no)+" ")],1)]}}])},[t._v(" Requested By: "+t._s(t.data.main.created_by)+" ")]),e("v-divider",{staticClass:"mx-2"}),e("v-tooltip",{attrs:{bottom:"","content-class":"rounded-xl"},scopedSlots:t._u([{key:"activator",fn:function({on:a,attrs:i}){return[e("p",t._g(t._b({staticClass:"mb-0"},"p",i,!1),a),[t._v(t._s(t.data.main.created_at||"-")+" "),e("v-icon",[t._v("mdi-clock-fast")])],1)]}}])},[t._v(" Request created time ")])],1),e("v-row",{staticClass:"align-center mx-0 my-0 mt-2"},[e("p",{staticClass:"mb-0"},[e("v-icon",[t._v("mdi-clipboard-text")]),t._v(" Main Data")],1),e("v-divider",{staticClass:"ml-2"})],1),e("v-simple-table",{attrs:{dense:""}},[e("tbody",[e("tr",[e("td",{staticStyle:{"max-width":"fit-content"}},[t._v("Distribution")]),e("td",[t._v(": "+t._s(t.data.main.distribution_date))])]),"Petani"==t.landProgram?e("tr",[e("td",{staticStyle:{"max-width":"fit-content"}},[t._v("Unit Manager")]),e("td",[t._v(": "+t._s(t.data.main.um_name||"-"))])]):t._e(),"Petani"==t.landProgram?e("tr",[e("td",{staticStyle:{"max-width":"fit-content"}},[t._v("FC")]),e("td",[t._v(": "+t._s(t.data.main.fc_name||"-"))])]):e("tr",[e("td",{staticStyle:{"max-width":"fit-content"}},[t._v("PIC T4T")]),e("td",[t._v(": "+t._s(t.data.main.pic_t4t_name||"-"))])]),"Petani"==t.landProgram?e("tr",[e("td",{staticStyle:{"max-width":"fit-content"}},[t._v("FF")]),e("td",[t._v(": "+t._s(t.data.main.ff_name||"-"))])]):e("tr",[e("td",{staticStyle:{"max-width":"fit-content"}},[t._v("PIC Lahan")]),e("td",[t._v(": "+t._s(t.data.main.pic_lahan_name||"-"))])]),"Petani"==t.landProgram?e("tr",[e("td",{staticStyle:{"max-width":"fit-content"}},[t._v("Farmer")]),e("td",[t._v(": "+t._s(t.data.main.farmer_name||"-"))])]):e("tr",[e("td",{staticStyle:{"max-width":"fit-content"}},[t._v("MoU No")]),e("td",[t._v(": "+t._s(t.data.main.mou_no||"-"))])]),e("tr",[e("td",{staticStyle:{"max-width":"fit-content"}},[t._v("Lahan")]),e("td",[t._v(": "+t._s(t.data.main.lahan_no||"-"))])]),e("tr",[e("td",{staticStyle:{"max-width":"fit-content"}},[t._v("Reason Notes")]),e("td",[t._v(": "+t._s(t.data.main.notes||"-")+" "),e("i",[t._v("("+t._s(t.data.main.created_by_name||"-")+")")])])])])]),t.data.main.last_activity?e("v-card",{key:t.components.activitiesCard,staticClass:"elevation-0 mt-3"},[e("v-card-title",{staticClass:"pb-0",attrs:{"data-aos":"zoom-in"}},[e("v-spacer",{staticClass:"mr-2"}),e("span",{staticClass:"grey--text text--darken-2"},[e("v-icon",{staticClass:"mr-1"},[t._v("mdi-timeline-check")]),t._v(" "+t._s("Petani"==t.landProgram?"Farmer":"MoU")+" Last Activities ")],1),e("v-spacer",{staticClass:"ml-2"})],1),e("v-card-text",{staticClass:"pb-0"},[e("v-stepper",{staticClass:"elevation-0",attrs:{"alt-labels":""},model:{value:t.data.main.last_activity_model,callback:function(e){t.$set(t.data.main,"last_activity_model",e)},expression:"data.main.last_activity_model"}},[e("v-stepper-header",{staticClass:"elevation-0"},[e("v-stepper-step",{attrs:{"data-aos":"zoom-in","data-aos-delay":"0",color:"green",step:"x",complete:t.data.main.last_activity_model>=1,rules:[()=>!(t.data.main.last_activity_model<1)],"error-icon":"mdi-close-circle"}},[e("small",[t._v("Pendataan Lahan")])]),e("v-divider",{}),"Petani"==t.landProgram?e("v-stepper-step",{attrs:{"data-aos":"zoom-in","data-aos-delay":"50",color:"green",step:"x",complete:t.data.main.last_activity_model>=2,rules:[()=>!(t.data.main.last_activity_model<2)],"error-icon":"mdi-close-circle"}},[e("small",[t._v("Sosialisasi Tanam")])]):t._e(),"Petani"==t.landProgram?e("v-divider",{}):t._e(),e("v-stepper-step",{attrs:{"data-aos":"zoom-in","data-aos-delay":"100",color:"green",step:"x",complete:t.data.main.last_activity_model>=3,rules:[()=>!(t.data.main.last_activity_model<3)],"error-icon":"mdi-close-circle"}},[e("small",[t._v("Penilikan Lubang")])]),e("v-divider",{}),e("v-stepper-step",{attrs:{"data-aos":"zoom-in","data-aos-delay":"150",color:"green",step:"x",complete:t.data.main.last_activity_model>=4,rules:[()=>!(t.data.main.last_activity_model<4)],"error-icon":"mdi-close-circle"}},[e("small",[t._v("Print Label")])]),e("v-divider",{}),e("v-stepper-step",{attrs:{"data-aos":"zoom-in","data-aos-delay":"200",color:"green",step:"x",complete:t.data.main.last_activity_model>=5,rules:[()=>!(t.data.main.last_activity_model<5)],"error-icon":"mdi-close-circle"}},[e("small",[t._v("Load Bag")])]),e("v-divider",{}),e("v-stepper-step",{attrs:{"data-aos":"zoom-in","data-aos-delay":"250",color:"green",step:"x",complete:t.data.main.last_activity_model>=6,rules:[()=>!(t.data.main.last_activity_model<6)],"error-icon":"mdi-close-circle"}},[e("small",[t._v("Distribute Bag")])]),e("v-divider",{}),e("v-stepper-step",{attrs:{"data-aos":"zoom-in","data-aos-delay":"300",color:"green",step:"x",complete:t.data.main.last_activity_model>=7,rules:[()=>!(t.data.main.last_activity_model<7)],"error-icon":"mdi-close-circle"}},[e("small",[t._v("Realisasi Tanam")])])],1)],1)],1)],1):t._e(),e("v-row",{staticClass:"align-center mx-0 my-0 mt-2"},[e("p",{staticClass:"mb-0"},[e("v-icon",[t._v("mdi-forest")]),t._v(" Seedling Change")],1),e("v-divider",{staticClass:"mx-2"}),e("v-icon",{staticClass:"mr-1 mb-1",attrs:{color:t.getTotalChangeColor}},[t._v("mdi-sprout")]),e("p",{staticClass:"mb-0",domProps:{innerHTML:t._s(t.getTotalChange)}})],1),e("v-data-table",{attrs:{dense:"","hide-default-footer":"","items-per-page":-1,"multi-sort":"",headers:t.seedHeaders,items:t.data.seeds||[]},scopedSlots:t._u([{key:"item.no",fn:function({index:e}){return[t._v(" "+t._s(e+1)+" ")]}},{key:"item.type",fn:function({item:a}){return[e("v-chip",{attrs:{small:"",color:t.getTypeColorAndLabel("color",a.type)}},[t._v(t._s(t.getTypeColorAndLabel("label",a.type)))])]}},{key:"item.new_amount",fn:function({item:a}){return[e("v-icon",{attrs:{color:t.getTypeColorAndLabel("color",a.type)}},[t._v("mdi-sprout")]),t._v(" "+t._s(a.old_amount)+" "),"same"!=a.type?e("span",[e("v-icon",{attrs:{small:""}},[t._v("mdi-chevron-double-right")]),t._v(" "+t._s(a.new_amount)+" ")],1):t._e()]}},{key:"header.is_checked",fn:function(){return[e("v-icon",{attrs:{small:""}},[t._v("mdi-checkbox-marked-circle-outline")]),t._v(" Confirm ("+t._s(t.data.seeds?t.data.seeds.filter(t=>!0===t.is_checked).length:"")+"/"+t._s(t.data.seeds?t.data.seeds.length:"")+") ")]},proxy:!0},{key:"item.is_checked",fn:function({item:a}){return[e("v-row",{staticClass:"mx-0"},[e("v-checkbox",{attrs:{"off-icon":"mdi-circle-outline","on-icon":"mdi-check-circle",color:"green",label:a.is_checked?"Confirmed":"Check"},model:{value:a.is_checked,callback:function(e){t.$set(a,"is_checked",e)},expression:"item.is_checked"}})],1)]}}])})],1)],1),e("v-snackbar",{staticClass:"d-flex",attrs:{color:t.snackbar.color,timeout:t.snackbar.timeout,"multi-line":t.snackbar.multiLine,rounded:"xl"},model:{value:t.snackbar.show,callback:function(e){t.$set(t.snackbar,"show",e)},expression:"snackbar.show"}},[e("div",{staticClass:"d-flex justify-between"},[e("p",{staticClass:"mb-0"},[t._v(" "+t._s(t.snackbar.text)+" ")]),e("v-spacer"),e("v-icon",{staticClass:"pl-1",attrs:{small:""},on:{click:()=>t.snackbar.show=!1}},[t._v("mdi-close-circle")])],1)])],1),"requested"==t.data.main.status?e("v-card-actions",{staticClass:"justify-center rounded-pill",staticStyle:{position:"relative"}},[e("v-hover",{scopedSlots:t._u([{key:"default",fn:function({hover:a}){return["IT"==t.User.role_group||"NURSERY MANAGER"==t.User.role_name?e("v-btn",{attrs:{rounded:"",outlined:!a,color:(a?"red":"white")+" white--text"},on:{click:()=>{t.dialogs.confirmation.type="cancel",t.dialogs.confirmation.model=!0}}},[e("v-icon",{staticClass:"mr-1"},[t._v("mdi-close-circle")]),t._v(" Cancel")],1):t._e()]}}],null,!1,2223304307)}),e("v-hover",{scopedSlots:t._u([{key:"default",fn:function({hover:a}){return["IT"==t.User.role_group||"PROGRAM MANAGER"==t.User.role_name||"REGIONAL MANAGER"==t.User.role_name?e("v-btn",{attrs:{rounded:"",outlined:!a,color:(a?"red":"white")+" white--text"},on:{click:()=>{t.dialogs.confirmation.type="reject",t.dialogs.confirmation.model=!0}}},[e("v-icon",{staticClass:"mr-1"},[t._v("mdi-file-document-remove")]),t._v(" Reject")],1):t._e()]}}],null,!1,1837915104)}),e("v-divider",{class:"mx-2 mr-5 "+("PROGRAM MANAGER"==t.User.role_name||"REGIONAL MANAGER"==t.User.role_name||"IT"==t.User.role_group?"":"my-2 transparent"),attrs:{color:"white"}}),e("v-tooltip",{attrs:{left:"","content-class":"rounded-xl"},scopedSlots:t._u([{key:"activator",fn:function({on:a,attrs:i}){return[e("v-btn",t._g(t._b({attrs:{disabled:t.disabledVerification,fab:"",rounded:"",absolute:"",top:"",right:"",color:"green white--text"},on:{click:()=>{t.showVerificationDialog()}}},"v-btn",i,!1),a),[e("v-icon",[t._v("mdi-check-all")])],1)]}}],null,!1,3325117097)},[t._v(" Verification Request ")])],1):t._e()],1)],1)],1)},s=[],o=a("bc3a"),n=a.n(o),r=a("caa4"),l={components:{confirmation:r["default"]},props:{show:{type:Boolean,default:!1},landProgram:{type:String,default:"Petani"},id:{type:String,default:null},settings:{type:Object,default:null}},data:()=>({components:{activitiesCard:29123},data:{main:{},seeds:[]},dialogs:{confirmation:{model:!1,type:""}},loading:{show:!1,text:""},seedHeaders:[{text:"No",value:"no",align:"center",width:"20px",sortable:!1},{text:"Lahan",value:"lahan_no"},{text:"Jenis",value:"tree_name"},{text:"Status",value:"type",align:"right"},{text:"Perubahan",value:"new_amount"},{text:"Check",value:"is_checked",align:"left"}],snackbar:{color:"green",timeout:5e3,show:!1,text:"Alert!",multiLine:!1},User:{}}),computed:{showDialog:{get:function(){return 1==this.show&&this.initialize(),this.show},set:async function(t){0==t&&this.$emit("close",{name:"detail"})}},disabledVerification(){const t=this.data,e=this.User,a=this.landProgram;let i=!1;if(t.main.request_no){const s=t.main.verification||0;if("Petani"==a)(0==s&&"FIELD COORDINATOR"!=e.role_name||1==s&&"UNIT MANAGER"!=e.role_name||2==s&&"PROGRAM MANAGER"!=e.role_name&&"REGIONAL MANAGER"!=e.role_name)&&(i=!0);else{const a=t.main.created_lu_email;(0==s&&a!=e.email||1==s&&"PROGRAM MANAGER"!=e.role_name&&"REGIONAL MANAGER"!=e.role_name)&&(i=!0)}"IT"==e.role_group&&(i=!1),t.seeds.filter(t=>!0===t.is_checked).length!=t.seeds.length&&(i=!0)}else i=!0;return i},getTotalChange(){const t=this.data.seeds;let e=0,a=0;return t.map(t=>{e+=parseInt(t.old_amount),a+=parseInt(t.new_amount)}),`<b>${e}</b> >> <b>${a}</b>`},getTotalChangeColor(){let t="";const e=this.data.seeds;let a=0,i=0;return e.map(t=>{a+=parseInt(t.old_amount),i+=parseInt(t.new_amount)}),a!=i&&(t="orange"),t},verificationStatus(){const t=this.data.main;let e=0;return t.verification&&(e=t.verification),"rejected"==t.status&&(e=3),e}},methods:{async initialize(){try{this.User=this.$store.state.User,this.id&&await this.getData(this.id)}catch(t){}},async getData(t){try{this.loading.show=!0,this.loading.text="Getting request detail...";const e=new URLSearchParams({request_no:t}),a=this.$store.getters.getApiUrl(`${this.settings.prefixUrl}DetailRequest?${e}`),i=this.settings.apiConfig,s=await n.a.get(a,i).then(t=>t.data);if(this.data.main=s.main,this.data.main.created_at=this.$store.getters.dateFormat(s.main.created_at,"HH:mm - DD MMMM Y"),this.data.main.distribution_date=this.$store.getters.dateFormat(s.main.distribution_date,"DD MMMM Y"),"Pendataan Lahan"==s.main.last_activity&&(this.data.main.last_activity_model=1),"Sosialisasi Tanam"==s.main.last_activity&&(this.data.main.last_activity_model=2),"Penilikan Lubang"==s.main.last_activity&&(this.data.main.last_activity_model=3),"Print Label"==s.main.last_activity&&(this.data.main.last_activity_model=4),"Load Bag"==s.main.last_activity&&(this.data.main.last_activity_model=5),"Distribute Bag"==s.main.last_activity&&(this.data.main.last_activity_model=6),"Realisasi Tanam"==s.main.last_activity&&(this.data.main.last_activity_model=7),this.components.activitiesCard+=1,this.data.seeds=await s.seeds.map(t=>({...t,is_checked:0})),3==this.data.main.verification){const t=this.seedHeaders.findIndex(t=>"is_checked"===t.value);t>-1&&this.seedHeaders.splice(t,1)}else{const t=this.seedHeaders.find(t=>"is_checked"==t.value);t||this.seedHeaders.push({text:"Check",value:"is_checked",align:"left"})}}catch(e){this.errorResponse(e)}finally{this.loading.show=!1,this.loading.text="Loading..."}},async verificationOrRejectConfirm(){try{this.loading.show=!0;const t=this.dialogs.confirmation;t.model=!1;let e=this.$store.getters.getApiUrl(""+this.settings.prefixUrl);const a=this.settings.apiConfig;if("verification"==t.type||"last_verification"==t.type){this.loading.text="Verifying data...",e+="Verification";const t=await n.a.post(e,{request_no:this.id},a).then(t=>t.data);t&&(this.snackbar.text=t,this.snackbar.color="green",this.$emit("close",{name:"detail",snackbar:{text:"Send request success!",color:"green",show:!0}}))}else if("reject"==t.type){this.loading.text="Rejecting data...",e+="Reject";const t=await n.a.post(e,{request_no:this.id},a).then(t=>t.data);t&&(this.snackbar.text=t,this.snackbar.color="green",this.$emit("close",{name:"detail",snackbar:{text:"Request rejected!",color:"green",show:!0}}))}else if("cancel"==t.type){this.loading.text="Canceling data...",e+="Cancel";const t=await n.a.post(e,{request_no:this.id},a).then(t=>t.data);t&&(this.snackbar.text=t,this.snackbar.color="green",this.$emit("close",{name:"detail",snackbar:{text:"Request canceled!",color:"green",show:!0}}))}}catch(t){this.errorResponse(t)}finally{this.snackbar.show=!0,this.loading.show=!1,this.loading.text="Loading..."}},showVerificationDialog(){const t=this.dialogs.confirmation,e=this.landProgram,a=this.data.main;"Petani"==e&&2==a.verification||"Umum"==e&&1==a.verification?t.type="last_verification":t.type="verification",t.model=!0},getTypeColorAndLabel(t,e){if("color"==t){let t="grey darken-1";return"remove"==e&&(t="red"),"change"==e&&(t="orange"),"new"==e&&(t="blue"),t+" white--text"}{let t="TETAP";return"remove"==e&&(t="HAPUS"),"change"==e&&(t="BERUBAH"),"new"==e&&(t="BARU"),t}},errorResponse(t){this.snackbar.text=t.message,this.snackbar.color="red",t.response&&"undefined"!=typeof t.response.status&&(401==t.response.status?(localStorage.removeItem("token"),this.$router.push("/")):400==t.response.status&&(this.snackbar.text=t.response.data)),this.snackbar.show=!0},statusColorAndIcon(t,e,a){let i="";return"request"==a?"color"==e?(i="requested"==t?"orange":"rejected"==t||"canceled"==t?"red":"green",i+" white--text"):(i="requested"==t?"chat-processing":"rejected"==t||"canceled"==t?"chat-remove":"check-decagram","mdi-"+i):"color"==e?(0==t?i="red":1==t?i="orange":2==t?i="yellow darken-2":3==t&&(i="green"),i+" white--text"):"icon"==e?(0==t?i="progress-alert":1==t?i="progress-check":2==t?i="check-circle":3==t&&(i="checkbox-multiple-marked-circle"),"mdi-"+i):(0==t?i="UNVERIFIED":1==t?i="VERIFIED FC":2==t?i="VERIFIED UM":3==t&&(i="VERIFIED RM / PM"),i)}}},c=l,d=a("2877"),m=a("6544"),_=a.n(m),v=a("8336"),h=a("b0af"),u=a("99d9"),p=a("ac7c"),g=a("cc20"),f=a("8fea"),y=a("169a"),b=a("ce7e"),x=a("ce87"),k=a("132d"),w=a("a797"),C=a("490a"),R=a("0fd9"),A=a("1f4f"),P=a("2db4"),S=a("2fa4"),V=a("7e85"),I=a("9c54"),M=a("56a4"),D=a("3a2f"),L=Object(d["a"])(c,i,s,!1,null,null,null);e["default"]=L.exports;_()(L,{VBtn:v["a"],VCard:h["a"],VCardActions:u["a"],VCardText:u["c"],VCardTitle:u["d"],VCheckbox:p["a"],VChip:g["a"],VDataTable:f["a"],VDialog:y["a"],VDivider:b["a"],VHover:x["a"],VIcon:k["a"],VOverlay:w["a"],VProgressCircular:C["a"],VRow:R["a"],VSimpleTable:A["a"],VSnackbar:P["a"],VSpacer:S["a"],VStepper:V["a"],VStepperHeader:I["a"],VStepperStep:M["a"],VTooltip:D["a"]})}}]);
//# sourceMappingURL=chunk-2d21442b.b8c48f6c.js.map