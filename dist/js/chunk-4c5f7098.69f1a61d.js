(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c5f7098"],{"2ba1":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-dialog",{attrs:{"content-class":"rounded-xl mx-1","max-width":"1200px",scrollable:"",persistent:""},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[a("v-card",[a("v-card-title",{staticClass:"mb-1 headermodalstyle rounded-xl"},[a("span",{staticClass:"white--text"},[a("v-btn",{staticClass:"white dark--text mr-1",attrs:{fab:"","x-small":""}},[a("v-icon",{attrs:{color:"grey darken-3"}},[t._v("mdi-file-account")])],1),t._v(" Export Excel Preview")],1),a("v-icon",{staticClass:"ml-auto",attrs:{color:"red lighten-1"},on:{click:function(e){t.showModal=!1}}},[t._v("mdi-close-circle")])],1),a("v-card-text",[a("v-overlay",{attrs:{absolute:"",value:t.loading.show}},[a("div",{staticClass:"d-flex flex-column justify-center align-center"},[a("LottieAnimation",{ref:"anim",staticStyle:{height:"64px"},attrs:{animationData:t.lottie.data.loading,loop:!0}}),a("p",{staticClass:"mt-2 mb-0"},[t._v(t._s(t.loading.text)+" "),a("v-progress-circular",{attrs:{size:17,width:3,indeterminate:"",color:"white"}})],1)],1)]),a("table",{staticStyle:{"border-collapse":"collapse","min-height":"400px"},attrs:{id:"tableForExport"}},[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"},attrs:{colspan:"8"}},[t._v(t._s(t.download.title))])]),a("tr",[a("td",{staticStyle:{"text-align":"left"},attrs:{colspan:"8"}},[t._v("Export Time: "+t._s(Date()))])]),a("tr",[a("td",{staticStyle:{"text-align":"left"},attrs:{colspan:"8"}},[t._v("Total Lahan: "+t._s(t.table.data.length))])]),a("tr"),a("tr",[a("th",[t._v("No")]),a("th",[t._v("MU")]),a("th",[t._v("TA")]),a("th",[t._v("Desa")]),a("th",[t._v("Nama Petani")]),a("th",[t._v("No Lahan")]),a("th",[t._v("No SPPT")]),a("th",[t._v("Tahun Tanam")]),a("th",[t._v("Monitoring No")]),t._l(t.table.trees,(function(e){return a("th",{key:"trees-header-"+e.tree_code},[t._v(t._s(e.tree_name))])}))],2)]),a("tbody",t._l(t.table.data,(function(e,n){return a("tr",{key:"table-row-"+n},[a("td",[t._v(t._s(n+1))]),a("td",[t._v(t._s(e.mu_name))]),a("td",[t._v(t._s(e.ta_name))]),a("td",[t._v(t._s(e.village_name))]),a("td",[t._v(t._s(e.farmer_name))]),a("td",[t._v(t._s(e.lahan_no))]),a("td",[t._v(t._s(e.document_no))]),a("td",[t._v(t._s(e.program_year))]),a("td",[t._v(t._s(e.monitoring_no))]),t._l(t.table.trees,(function(n){return a("td",{key:"trees-column-"+n.tree_code},[t._v(t._s(e[n.tree_code]||0))])}))],2)})),0)])],1),a("v-card-actions",[a("v-divider",{staticClass:"mr-2"}),a("v-btn",{attrs:{color:"blue white--text",rounded:""},on:{click:function(){return t.downloadExcel()}}},[a("v-icon",[t._v("mdi-download")]),t._v(" Download")],1),a("v-divider",{staticClass:"ml-2"})],1)],1)],1)},o=[],r=a("2909"),l=a("1da1"),s=(a("96cf"),a("99af"),a("d81d"),a("bc3a")),i=a.n(s),c=a("86e6"),d=a("1d71"),h={components:{LottieAnimation:c["a"]},props:{show:{type:Boolean,default:!1},data:{type:Array,default:[]}},data:function(){return{download:{title:"Export LAHAN 2021 & 2022 (SPPT Required & Plants)"},loading:{show:!1,text:""},lottie:{data:{loading:d}},table:{data:[],trees:[]}}},computed:{showModal:{get:function(){return this.show&&this.getTableData(),this.show},set:function(t){0==t&&this.$emit("close")}}},watch:{"table.data":{handler:function(t){console.log(t)}}},mounted:function(){},methods:{downloadExcel:function(){var t=document.getElementById("tableForExport"),e=XLSX.utils.table_to_book(t);XLSX.writeFile(e,"".concat(this.download.title,".xlsx"))},getTableData:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var a,n,o,l,s,c,d,h,v,u,_,g;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,a=t.loading,t.table.data=[],a.show=!0,a.text="Preparing data...",n=["04-0007","04-0015","04-0037","09-00998","04-0050","01-0002"],o=0,l=t.$store,a.text="Getting data UM ".concat(o," / ").concat(n.length,"..."),s=0;case 10:if(!(s<n.length)){e.next=38;break}return c=0,e.next=14,i.a.get(l.getters.getApiUrl("GetEmployeebyManager?position=19&manager_code=".concat(n[s])),l.state.apiConfig);case 14:d=e.sent,h=d.data.data.result.data.map((function(t){return t.nik})),a.text="Done UM ".concat(o," / ").concat(n.length," FC ").concat(c," / ").concat(h.length,"..."),v=0;case 18:if(!(v<h.length)){e.next=30;break}return e.next=21,i.a.get(l.getters.getApiUrl("GetDataLahanByDocumentSPPT?fc_no=".concat(h[v])),l.state.apiConfig);case 21:_=e.sent,g=_.data.data,0===t.table.trees.length&&(t.table.trees=_.data.trees),(u=t.table.data).push.apply(u,Object(r["a"])(g)),c+=1,a.text="Done UM ".concat(o," / ").concat(n.length," FC ").concat(c," / ").concat(h.length,"...");case 27:v++,e.next=18;break;case 30:o+=1,t.download.title=t.download.title+" "+o,t.downloadExcel(),a.text="Done UM ".concat(o," / ").concat(n.length," FC ").concat(c," / ").concat(h.length,"..."),o===n.length&&c===h.length&&(a.show=!1);case 35:s++,e.next=10;break;case 38:console.log(t.table);case 39:return e.prev=39,t.loading.show=!1,e.finish(39);case 42:case"end":return e.stop()}}),e,null,[[0,,39,42]])})))()}}},v=h,u=a("2877"),_=a("6544"),g=a.n(_),m=a("8336"),p=a("b0af"),x=a("99d9"),b=a("169a"),f=a("ce7e"),w=a("132d"),y=a("a797"),C=a("490a"),k=Object(u["a"])(v,n,o,!1,null,null,null);e["default"]=k.exports;g()(k,{VBtn:m["a"],VCard:p["a"],VCardActions:x["a"],VCardText:x["c"],VCardTitle:x["d"],VDialog:b["a"],VDivider:f["a"],VIcon:w["a"],VOverlay:y["a"],VProgressCircular:C["a"]})},"8ce9":function(t,e,a){},ce7e:function(t,e,a){"use strict";var n=a("5530"),o=(a("8ce9"),a("7560"));e["a"]=o["a"].extend({name:"v-divider",props:{inset:Boolean,vertical:Boolean},render:function(t){var e;return this.$attrs.role&&"separator"!==this.$attrs.role||(e=this.vertical?"vertical":"horizontal"),t("hr",{class:Object(n["a"])({"v-divider":!0,"v-divider--inset":this.inset,"v-divider--vertical":this.vertical},this.themeClasses),attrs:Object(n["a"])({role:"separator","aria-orientation":e},this.$attrs),on:this.$listeners})}})}}]);
//# sourceMappingURL=chunk-4c5f7098.69f1a61d.js.map