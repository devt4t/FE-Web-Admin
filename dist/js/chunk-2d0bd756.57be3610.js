(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0bd756"],{"2ba1":function(t,a,e){"use strict";e.r(a);var l=function(){var t=this,a=t._self._c;return a("v-dialog",{attrs:{"content-class":"rounded-xl mx-1","max-width":"1200px",scrollable:"",persistent:""},model:{value:t.showModal,callback:function(a){t.showModal=a},expression:"showModal"}},[a("v-card",[a("v-card-title",{staticClass:"mb-1 headermodalstyle rounded-xl"},[a("span",{staticClass:"white--text"},[a("v-btn",{staticClass:"white dark--text mr-1",attrs:{fab:"","x-small":""}},[a("v-icon",{attrs:{color:"grey darken-3"}},[t._v("mdi-file-account")])],1),t._v(" Export Excel Preview")],1),a("v-icon",{staticClass:"ml-auto",attrs:{color:"red lighten-1"},on:{click:function(a){t.showModal=!1}}},[t._v("mdi-close-circle")])],1),a("v-card-text",[a("v-overlay",{attrs:{absolute:"",value:t.loading.show}},[a("div",{staticClass:"d-flex flex-column justify-center align-center"},[a("LottieAnimation",{ref:"anim",staticStyle:{height:"64px"},attrs:{animationData:t.lottie.data.loading,loop:!0}}),a("p",{staticClass:"mt-2 mb-0"},[t._v(t._s(t.loading.text)+" "),a("v-progress-circular",{attrs:{size:17,width:3,indeterminate:"",color:"white"}})],1)],1)]),a("table",{staticStyle:{"border-collapse":"collapse","min-height":"400px"},attrs:{id:"tableForExport"}},[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"},attrs:{colspan:"8"}},[t._v(t._s(t.download.title))])]),a("tr",[a("td",{staticStyle:{"text-align":"left"},attrs:{colspan:"8"}},[t._v("Export Time: "+t._s(Date()))])]),a("tr",[a("td",{staticStyle:{"text-align":"left"},attrs:{colspan:"8"}},[t._v("Total Lahan: "+t._s(t.table.data.length))])]),a("tr"),a("tr",[a("th",[t._v("No")]),a("th",[t._v("MU")]),a("th",[t._v("TA")]),a("th",[t._v("Desa")]),a("th",[t._v("Nama Petani")]),a("th",[t._v("No Lahan")]),a("th",[t._v("No SPPT")]),a("th",[t._v("Tahun Tanam")]),a("th",[t._v("Monitoring No")]),t._l(t.table.trees,(function(e){return a("th",{key:"trees-header-"+e.tree_code},[t._v(t._s(e.tree_name))])}))],2)]),a("tbody",t._l(t.table.data,(function(e,l){return a("tr",{key:"table-row-"+l},[a("td",[t._v(t._s(l+1))]),a("td",[t._v(t._s(e.mu_name))]),a("td",[t._v(t._s(e.ta_name))]),a("td",[t._v(t._s(e.village_name))]),a("td",[t._v(t._s(e.farmer_name))]),a("td",[t._v(t._s(e.lahan_no))]),a("td",[t._v(t._s(e.document_no))]),a("td",[t._v(t._s(e.program_year))]),a("td",[t._v(t._s(e.monitoring_no))]),t._l(t.table.trees,(function(l){return a("td",{key:"trees-column-"+l.tree_code},[t._v(t._s(e[l.tree_code]||0))])}))],2)})),0)])],1),a("v-card-actions",[a("v-divider",{staticClass:"mr-2"}),a("v-btn",{attrs:{color:"blue white--text",rounded:""},on:{click:()=>t.downloadExcel()}},[a("v-icon",[t._v("mdi-download")]),t._v(" Download")],1),a("v-divider",{staticClass:"ml-2"})],1)],1)],1)},o=[],n=e("bc3a"),s=e.n(n),i=e("86e6"),r=e("1d71"),d={components:{LottieAnimation:i["a"]},props:{show:{type:Boolean,default:!1},data:{type:Array,default:[]}},data:()=>({download:{title:"Export LAHAN 2021 & 2022 (SPPT Required & Plants)"},loading:{show:!1,text:""},lottie:{data:{loading:r}},table:{data:[],trees:[]}}),computed:{showModal:{get:function(){return this.show&&this.getTableData(),this.show},set:function(t){0==t&&this.$emit("close")}}},watch:{"table.data":{handler(t){console.log(t)}}},mounted(){},methods:{downloadExcel(){const t=document.getElementById("tableForExport"),a=XLSX.utils.table_to_book(t);XLSX.writeFile(a,this.download.title+".xlsx")},async getTableData(){try{let t=this.loading;this.table.data=[],t.show=!0,t.text="Preparing data...";const a=["04-0007","04-0015","04-0037","09-00998","04-0050","01-0002"];let e=0,l=this.$store;t.text=`Getting data UM ${e} / ${a.length}...`;for(let o=0;o<a.length;o++){let n=0;const i=await s.a.get(l.getters.getApiUrl("GetEmployeebyManager?position=19&manager_code="+a[o]),l.state.apiConfig),r=i.data.data.result.data.map(t=>t.nik);t.text=`Done UM ${e} / ${a.length} FC ${n} / ${r.length}...`;for(let o=0;o<r.length;o++){const i=await s.a.get(l.getters.getApiUrl("GetDataLahanByDocumentSPPT?fc_no="+r[o]),l.state.apiConfig),d=i.data.data;0===this.table.trees.length&&(this.table.trees=i.data.trees),this.table.data.push(...d),n+=1,t.text=`Done UM ${e} / ${a.length} FC ${n} / ${r.length}...`}e+=1,this.download.title=this.download.title+" "+e,this.downloadExcel(),t.text=`Done UM ${e} / ${a.length} FC ${n} / ${r.length}...`,e===a.length&&n===r.length&&(t.show=!1)}console.log(this.table)}finally{this.loading.show=!1}}}},c=d,h=e("2877"),_=e("6544"),v=e.n(_),g=e("8336"),u=e("b0af"),m=e("99d9"),p=e("169a"),w=e("ce7e"),b=e("132d"),x=e("a797"),f=e("490a"),y=Object(h["a"])(c,l,o,!1,null,null,null);a["default"]=y.exports;v()(y,{VBtn:g["a"],VCard:u["a"],VCardActions:m["a"],VCardText:m["c"],VCardTitle:m["d"],VDialog:p["a"],VDivider:w["a"],VIcon:b["a"],VOverlay:x["a"],VProgressCircular:f["a"]})}}]);
//# sourceMappingURL=chunk-2d0bd756.57be3610.js.map