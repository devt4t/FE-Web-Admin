(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e956f"],{"8cb0":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t._self._c;return e("div",[e("v-card",{staticClass:"rounded-xl elevation-0 overflow-hidden"},[e("v-card-text",{staticClass:"pa-0",staticStyle:{position:"relative"}},[t.maps.loading.show?e("v-overlay",{attrs:{absolute:"","justify-center":"","align-center":""}},[e("div",{staticClass:"d-flex flex-column align-center justify-center"},[e("v-progress-circular",{attrs:{size:80,width:7,indeterminate:"",color:"white"}}),e("p",{staticClass:"mb-0 text-center mt-4"},[t._v(t._s(t.maps.loading.text||"Loading..."))])],1)]):t._e(),e("div",{staticClass:"overflow-hidden rounded-xl",staticStyle:{position:"relative"},attrs:{id:"mapboxWrapper","data-aos":"fade-down"}},[e("div",{staticStyle:{position:"absolute",top:"10px",left:"10px","z-index":"2"}},[e("v-menu",{attrs:{transition:"slide-y-transition",bottom:"","content-class":"rounded-xl"},scopedSlots:t._u([{key:"activator",fn:function({attrs:a,on:o}){return[e("div",t._g(t._b({},"div",a,!1),o),[e("v-btn",{staticStyle:{position:"relative","z-index":"3"},attrs:{"data-aos":"zoom-in","data-aos-delay":"500",fab:"",small:""}},[e("v-icon",[t._v("mdi-layers-triple")])],1),null!==t.layers.selected?e("v-chip",{key:t.layers.key,staticClass:"pl-7 white--text",staticStyle:{transform:"translateX(-20px)","z-index":"2",cursor:"pointer","background-color":"#00000099"},attrs:{"data-aos":"fade-right","data-aos-delay":"700"}},[t._v(t._s(t.layers.items[t.layers.selected].text||"-")+" "),e("v-icon",{staticClass:"ml-1 white--text"},[t._v(t._s(t.layers.items[t.layers.selected].icon))])],1):t._e()],1)]}}])},[e("v-card",[e("v-card-text",{staticClass:"pa-2"},t._l(t.layers.items,(function(a,o){return e("v-btn",{key:"layer"+o,attrs:{text:"",block:"",rounded:""},on:{click:()=>t.layers.selected=o}},[e("v-icon",{staticClass:"mr-1"},[t._v(t._s(a.icon))]),t._v(" "+t._s(a.text)+" ")],1)})),1)],1)],1)],1),e("div",{key:t.maps.key,ref:"mapbox",staticClass:"rounded-xl overflow-hidden",staticStyle:{height:"300px",width:"100%"},attrs:{id:"DetailModalMapBoxContainer"}}),t.fileNotFound?e("div",{staticClass:"d-flex flex-column justify-center align-center grey lighten-3",staticStyle:{position:"absolute",top:"0",left:"0",bottom:"0",right:"0"}},[e("v-icon",{attrs:{size:"60"}},[t._v("mdi-file-document-remove")]),t._v(" File data polygon tidak ditemukan ")],1):t._e()])],1)],1)],1)},l=[],s=(a("bc3a"),a("3d20")),i=a.n(s),r={props:{data:{type:Object,default:{village_polygon:null,dry_land_polygon:null}}},data:()=>({maps:{accessToken:"",mapStyle:"",model:null,attribution:'&copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a>',center:[113.9213,-.7893],url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",legends:{model:""},listMarker:[],loading:{show:!1,text:"Loading..."},zoom:3,geojson:{},key:111,layerId:0,hoveredStateId:0,layerStyle:{outline:{color:"#000000"},fill:{color:"#f06800"}},popup:{model:!1,content:{title:"",description:""}}},layers:{selected:null,key:229290021,items:[{key:"village_polygon",text:"Desa",icon:"mdi-home",url:""},{key:"dry_land_polygon",text:"Lahan Kering",icon:"mdi-land-plots-circle",url:""}]}}),async mounted(){this.maps.accessToken=this.$store.state.maps.accessToken,this.maps.mapStyle=this.$store.state.maps.mapStyle,this.showPolygonData},computed:{showPolygonData(){const t=this.data;let e=0;return this.layers.selected=null,t.village_polygon?(e+=1,this.layers.items[0].url=t.village_polygon,this.layers.selected=0):this.layers.items[0].url=null,t.dry_land_polygon?(e+=1,this.layers.items[1].url=t.dry_land_polygon,1===e&&(this.layers.selected=1)):this.layers.items[1].url=null,e>0},fileNotFound(){let t=this.layers.selected;return 0==this.showPolygonData||null!==t&&!this.layers.items[t].url}},watch:{"layers.selected":{async handler(t){this.layers.key+=1,null!==t&&await this.getPolygonData(t)}}},methods:{errorResponse(t){console.log(t),t.response&&(t.response.status?401==t.response.status?(localStorage.removeItem("token"),this.$router.push("/")):i.a.fire({title:"Error!",text:""+t.response.message,icon:"error",confirmButtonColor:"#f44336"}):i.a.fire({title:"Error!",text:""+t.message,icon:"error",confirmButtonColor:"#f44336"}))},async getPolygonData(t){try{const a=this.maps,o=this.layers.items;if(mapboxgl.accessToken=a.accessToken,mapboxgl.supported()){if(o[t].url){a.loading.show=!0;const l=`${this.$store.state.apiUrlImage}${o[t].url}`;let s=a.layerId;const r=a.layerStyle,n=this._utils.generateRandomString(5)+Date.now();r.fill.color=this._utils.getRandomColor(),a.loading.text="Getting polygon data...";var e=await omnivore.kml(l).on("ready",(async function(){const t=await e.toGeoJSON();if(await t.features.map((t,e)=>{t.id=s+=1}),0===t.features.length)a.loading.show=await!1,await i.a.fire({title:"Error!",text:"Polygon Features is 0.",icon:"error",confirmButtonColor:"#f44336"});else{a.loading.text="Initialize map...";let e=await new mapboxgl.Map({container:"DetailModalMapBoxContainer",style:a.mapStyle,center:a.center,zoom:a.zoom,projection:"globe"});await e.dragRotate.disable(),await e.touchZoomRotate.disableRotation(),await e.addControl(new mapboxgl.FullscreenControl),await e.on("load",(async function(){await e.setFog({color:"rgb(186, 210, 235)","high-color":"rgb(36, 92, 223)","horizon-blend":.02,"space-color":"rgb(11, 11, 25)","star-intensity":.6}),await e.addControl(new mapboxgl.NavigationControl),await e.addSource(n,{type:"geojson",data:t}),await e.addLayer({id:n+"-fills",type:"fill",source:n,layout:{},paint:{"fill-color":r.fill.color,"fill-opacity":["case",["boolean",["feature-state","hover"],!1],.1,.5]}}),await e.addLayer({id:n+"-outline",type:"line",source:n,layout:{},paint:{"line-color":r.outline.color,"line-width":2}});var o=turf.center(t);const l=o.geometry.coordinates;await e.flyTo({center:[l[0],l[1]],zoom:11,duration:7e3}),a.loading.show=await!1}))}}))}}else i.a.fire({title:"Warning!",text:"Your browser does not support Mapbox GL.",icon:"error",confirmButtonColor:"#f44336"})}catch(a){this.errorResponse(a)}}}},n=r,c=a("2877"),d=a("6544"),p=a.n(d),y=a("8336"),u=a("b0af"),m=a("99d9"),g=a("cc20"),h=a("132d"),f=a("e449"),v=a("a797"),w=a("490a"),x=Object(c["a"])(n,o,l,!1,null,null,null);e["default"]=x.exports;p()(x,{VBtn:y["a"],VCard:u["a"],VCardText:m["c"],VChip:g["a"],VIcon:h["a"],VMenu:f["a"],VOverlay:v["a"],VProgressCircular:w["a"]})}}]);
//# sourceMappingURL=chunk-2d0e956f.9901c6cc.js.map